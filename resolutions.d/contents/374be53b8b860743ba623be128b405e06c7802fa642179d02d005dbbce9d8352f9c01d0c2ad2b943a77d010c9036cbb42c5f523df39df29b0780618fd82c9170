    // Use adapter registry to handle operator replacement
    auto keepOperator = 1; // Default: keep original
    const auto& adapter = thisOpProps.adapter;
    bool isPureCpuOperator = true;

    if (adapter) {
      keepOperator = adapter->keepOperator();
      if (keepOperator == 0) {
        if (planNode && thisOpProps.canRunOnGPU) {
          auto replacements =
              adapter->createReplacements(oper, planNode, ctx, id);
          for (auto& r : replacements) {
            replaceOp.push_back(std::move(r));
          }
          isPureCpuOperator = false;
        } else {
          // This is the CPU fallback case.
          isPureCpuOperator = true;
        }
