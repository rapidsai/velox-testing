# This node is a worker; it executes tasks but doesn't coordinate queries.
coordinator=false
# Worker REST/HTTP port for internal and admin endpoints.
http-server.http.port=8080
# Address of the coordinator's discovery service for registration.
discovery.uri=http://presto-coordinator:8080

# Set Presto version string to match the coordinator for compatibility.
presto.version=testversion

# Total system memory available to Presto native process on this node (GB).
system-memory-gb={{ .NativeSystemMemGb }}
# Memory pool reserved for queries on this node (GB).
query-memory-gb={{ .NativeQueryMemGb }}
# Memory limit per node enforced by the coordinator for this worker.
query.max-memory-per-node={{ .NativeQueryMemGb }}GB
# Use the shared memory arbitrator to coordinate memory between tasks.
memory-arbitrator-kind=SHARED

# Parallel driver cap per task; templated to fully utilize vCPUs on CPU nodes.
task.max-drivers-per-task={{ .VCPUPerWorker }}

# Collect runtime metrics from the native engine for debugging and tuning.
runtime-metrics-collection-enabled=true
# Enable memory pushback to respect container limits and avoid OOM kills.
# Limit Velox memory to below container limit to maintain safety margin.
system-mem-pushback-enabled=true
system-mem-limit-gb={{ sub .ContainerMemoryGb .GeneratorParameters.MemoryPushBackStartBelowLimitGb }}
system-mem-shrink-gb=20

# Each multiplier value affects number of threads used for each module.
# hw_concurrency x multiplier.
# 1.0 is default for each multiplier config.
# Number of threads for HTTP IO executor
http-server.num-io-threads-hw-multiplier=0.01
# Number of threads for HTTP CPU executor
http-server.num-cpu-threads-hw-multiplier=0.01
# Number of threads for CPU executor for connectors mainly for async operators
# If 0.0 then connector CPU executor would not be created.
# 0.0 is default.
#connector.num-cpu-threads-hw-multiplier=0.0
# Number of threads for IO executor for connectors mainly to do preload/prefetch:
# If 0.0 then connector preload/prefetch is disabled.
# 0.0 is default.
connector.num-io-threads-hw-multiplier=0.01
# Number of threeads for Driver CPU executor
# 4.0 is default. 4*nproc threads.
#driver.num-cpu-threads-hw-multiplier
# Number of threads for Spiller CPU executor
# If 0.0 then spilling is disabled.
# 1.0 is default.
#spiller.num-cpu-threads-hw-multiplier
# Number of threads for Exchange HTTP client CPU executor
exchange.http-client.num-cpu-threads-hw-multiplier=0.01
# Number of threads for Exchange HTTP client IO executor
exchange.http-client.num-io-threads-hw-multiplier=0.01

# Optimize for single-node execution when the entire query can run locally.
# overwritten to "false" in multi-node settings.
single-node-execution-enabled=true

# Enable cuDF (CPU mode will ignore this setting)
cudf.enabled=true
# overwritten to "true" in multi-node settings.
cudf.exchange=false
# overwritten when cudf.exchange is enabled (ignored otherwise)
cudf.exchange.server.port=0000
cudf.memory_resource=async

async-data-cache-enabled=false
