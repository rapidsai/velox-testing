# Select the connector implementation. "hive-hadoop2" uses the Hive connector
# backed by Hadoop 2.x libraries which is the default for Presto's Hive support.
connector.name=hive-hadoop2

# Configure the metastore implementation. "file" enables a simple file-based
# metastore suitable for local testing without an external Hive Metastore (HMS).
# See https://prestodb.io/docs/current/installation/deployment.html#configuring-a-file-based-metastore for more details.
hive.metastore=file
# Root directory where the file-based metastore stores table and partition
# metadata. This path is inside the container volume so state persists across
# server restarts during tests.
hive.metastore.catalog.dir=file:/var/lib/presto/data/hive/metastore
# Allow DROP TABLE statements. Enabled to make smoke/perf tests able to reset
# state and clean up artifacts without manual intervention.
hive.allow-drop-table=true

# Control whether Presto can split files for parallel reads. Disable when the
# file compression/format isn't splittable to avoid read failures. TPCH Parquet
# test data commonly uses SNAPPY compression that isn't splittable at the file
# level here, hence this must be false.
hive.file-splittable=false

# Reduce query start gap by caching metastore and file listings.
hive.metastore-cache-ttl=10m
hive.metastore-refresh-interval=2m
hive.metastore-cache-maximum-size=100000
hive.per-transaction-metastore-cache-maximum-size=10000

# Cache filesystem listings for all tables to avoid repeated listLocatedStatus.
hive.file-status-cache-tables=*
hive.file-status-cache.max-retained-size=1GB
hive.file-status-cache-expire-time=30m

# Prefer manifests if available to avoid filesystem listing.
hive.prefer-manifests-to-list-files=true

# Speed up partition enumeration and split discovery.
hive.partition-filtering-from-metastore-enabled=true
hive.parallel-parsing-of-partition-values-enabled=true
hive.max-parallel-parsing-concurrency=16
hive.optimize-parsing-of-partition-values-enabled=true
hive.optimize-parsing-of-partition-values-threshold=200
hive.split-loader-concurrency=16
