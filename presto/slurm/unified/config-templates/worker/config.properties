# This node is a worker; it executes tasks but doesn't coordinate queries.
coordinator=false
# Worker REST/HTTP port for internal and admin endpoints.
http-server.http.port=__HTTP_PORT__
# Address of the coordinator's discovery service for registration.
discovery.uri=http://__COORD_HOST__:__PORT__

# Set Presto version string to match the coordinator for compatibility.
presto.version=testversion

# Total system memory available to Presto native process on this node (GB).
system-memory-gb=__SYSTEM_MEM_GB__
# Memory pool reserved for queries on this node (GB).
query-memory-gb=__QUERY_MEM_GB__
# Memory limit per node enforced by the coordinator for this worker.
query.max-memory-per-node=__QUERY_MEM_GB__GB
# Use the shared memory arbitrator to coordinate memory between tasks.
memory-arbitrator-kind=SHARED

# Parallel driver cap per task; templated to fully utilize vCPUs on CPU nodes.
task.max-drivers-per-task=__MAX_DRIVERS__

# Collect runtime metrics from the native engine for debugging and tuning.
runtime-metrics-collection-enabled=true
# Enable memory pushback to respect container limits and avoid OOM kills.
# Limit Velox memory to below container limit to maintain safety margin.
system-mem-pushback-enabled=true
system-mem-limit-gb=__SYSTEM_MEM_LIMIT_GB__
system-mem-shrink-gb=20

# Optimize for single-node execution when the entire query can run locally.
single-node-execution-enabled=__SINGLE_NODE_EXECUTION__

# Enable cuDF (CPU mode will ignore this setting)
cudf.enabled=true
cudf.exchange=__CUDF_EXCHANGE__
cudf.exchange.server.port=__EXCHANGE_PORT__
async-data-cache-enabled=false

# Disable JIT expression, may cause errors (e.g., q8 @ 64 workers): `Jitify fatal error: Failed to lock /root/.cudf/26.04.00/100/transform%2Fjit%2Fkernel.cu.lock: (116) Stale file handle`
cudf.jit_expression_enabled=false
